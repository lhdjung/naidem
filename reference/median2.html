<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Drop-in replacement for median() — median2 • naidem</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Drop-in replacement for median() — median2"><meta name="description" content='median2() computes the sample median. By default, it works
like median() from base R, with these exceptions:
If some values are missing, median2() checks if the median can still
be determined. median() always returns NA in this case, but median2()
only returns NA if the median is genuinely unknown.
You can opt to only ignore a certain number of missing values using the
na.rm.amount and na.rm.from arguments.
Strings, factors and all other data that can be ordered by sort() are
allowed. However, non-numeric data, including dates and factors, require
one of even = "low" and even = "high". This avoids "computing the mean"
of the two central values of sorted vectors with an even length when no
such operation is possible, e.g., with strings.
The return type is always double if the input vector is numeric (i.e.,
double or integer), for both even and odd lengths.

'><meta property="og:description" content='median2() computes the sample median. By default, it works
like median() from base R, with these exceptions:
If some values are missing, median2() checks if the median can still
be determined. median() always returns NA in this case, but median2()
only returns NA if the median is genuinely unknown.
You can opt to only ignore a certain number of missing values using the
na.rm.amount and na.rm.from arguments.
Strings, factors and all other data that can be ordered by sort() are
allowed. However, non-numeric data, including dates and factors, require
one of even = "low" and even = "high". This avoids "computing the mean"
of the two central values of sorted vectors with an even length when no
such operation is possible, e.g., with strings.
The return type is always double if the input vector is numeric (i.e.,
double or integer), for both even and odd lengths.

'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">naidem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/algorithm.html">Implementing the algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/proof.html">Proving the algorithm</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lhdjung/naidem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Drop-in replacement for <code>median()</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/lhdjung/naidem/blob/master/R/median2.R" class="external-link"><code>R/median2.R</code></a></small>
      <div class="d-none name"><code>median2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>median2()</code> computes the sample median. By default, it works
like <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median()</a></code> from base R, with these exceptions:</p><ul><li><p>If some values are missing, <code>median2()</code> checks if the median can still
be determined. <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median()</a></code> always returns <code>NA</code> in this case, but <code>median2()</code>
only returns <code>NA</code> if the median is genuinely unknown.</p></li>
<li><p>You can opt to only ignore a certain number of missing values using the
<code>na.rm.amount</code> and <code>na.rm.from</code> arguments.</p></li>
<li><p>Strings, factors and all other data that can be ordered by <code><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort()</a></code> are
allowed. However, non-numeric data, including dates and factors, require
one of <code>even = "low"</code> and <code>even = "high"</code>. This avoids "computing the mean"
of the two central values of sorted vectors with an even length when no
such operation is possible, e.g., with strings.</p></li>
<li><p>The return type is always double if the input vector is numeric (i.e.,
double or integer), for both even and odd lengths.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">median2</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na.rm.amount <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  na.rm.from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first"</span>, <span class="st">"last"</span>, <span class="st">"random"</span><span class="op">)</span>,</span>
<span>  even <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">median2</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na.rm.amount <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  na.rm.from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first"</span>, <span class="st">"last"</span>, <span class="st">"random"</span><span class="op">)</span>,</span>
<span>  even <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Vector that can be ordered using <code><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort()</a></code>. It will be searched for
its median.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical. If set to <code>TRUE</code>, missing values are removed before
computation proceeds. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-na-rm-amount">na.rm.amount<a class="anchor" aria-label="anchor" href="#arg-na-rm-amount"></a></dt>
<dd><p>Numeric. Alternative to <code>na.rm</code> that only removes a
specified number of missing values. Default is <code>0</code>.</p></dd>


<dt id="arg-na-rm-from">na.rm.from<a class="anchor" aria-label="anchor" href="#arg-na-rm-from"></a></dt>
<dd><p>String. If <code>na.rm.amount</code> is used, from which position in
<code>x</code> should missing values be removed? Options are <code>"first"</code>, <code>"last"</code>, and
<code>"random"</code>. Default is <code>"first"</code>.</p></dd>


<dt id="arg-even">even<a class="anchor" aria-label="anchor" href="#arg-even"></a></dt>
<dd><p>String. What to return if <code>x</code> has an even length and contains no
missing values (or they were removed). The default, <code>"mean"</code>, averages the
two central values of the sorted vector, <code>"low"</code> returns the lower central
value, and <code>"high"</code> returns the higher one. Note that <code>"mean"</code> is only
allowed if <code>x</code> is numeric.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional further arguments for methods. Not used in the default
method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Length-1 vector of type double if the input is numeric, and the same
type as <code>x</code> otherwise. This is tested by <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric()</a></code>, so factors and
dates do not count as numeric.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The main point of <code>median2()</code> is to handle missing values correctly.
For the motivation behind the other differences from <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median()</a></code>, see
<a href="https://design.tidyverse.org/out-type-stability.html#challenge-the-median" class="external-link"><em>Tidy design principles</em></a>.</p>
<p><code>median2()</code> is a generic function, so new methods can be defined for it. As
with <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">stats::median()</a></code> from base R, the default method described here
should work for most classes for which a median is a reasonable concept
(e.g., "<code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Date</a></code>").</p>
<p>If a new method is necessary, please make sure it deals with missing values
like the default method does. See
<a href="https://lhdjung.github.io/naidem/articles/algorithm.html"><em>Implementing
the algorithm</em></a> for further details.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lukas Jung, R Core Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># If no values are missing,</span></span></span>
<span class="r-in"><span><span class="co"># it works mostly like `median()`:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.5</span>
<span class="r-in"><span><span class="fu">median2</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="fu">median2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With some `NA`s, the median can</span></span></span>
<span class="r-in"><span><span class="co"># sometimes still be determined...</span></span></span>
<span class="r-in"><span><span class="fu">median2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="fu">median2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ...unless there are too many `NA`s...</span></span></span>
<span class="r-in"><span><span class="fu">median2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ...or too many unique values:</span></span></span>
<span class="r-in"><span><span class="fu">median2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

